//entry
function init() {
    var canvas1 = document.getElementById("canvas1"),
        canvas2 = document.getElementById("canvas2"),
        canvas3 = document.getElementById("canvas3"),
        canvas4 = document.getElementById("canvas4"),
        canvas5 = document.getElementById("canvas5"),
        params1 = {
            "w": 300,
            "h": 300,
            "flexible": true,
            "loop": true,
            "yoyo": true,
            "images": ["img/01.jpg", "img/02.jpg"],
            "vertices": [
                [
                    [ 0, 0 ],
                    [ 150, 0 ],
                    [ 300, 0 ],
                    [ 0, 150 ],
                    [ 300, 150 ],
                    [ 0, 300 ],
                    [ 150, 300 ],
                    [ 300, 300 ],
                    [ 117, 118 ],
                    [ 191, 117 ],
                    [ 154, 167 ],
                    [ 154, 231 ],
                    [ 109, 228 ],
                    [ 201, 230 ],
                    [ 155, 77 ],
                    [ 156, 274 ]
                ],
                [
                    [ 0, 0 ],
                    [ 150, 0 ],
                    [ 300, 0 ],
                    [ 0, 150 ],
                    [ 300, 150 ],
                    [ 0, 300 ],
                    [ 150, 300 ],
                    [ 300, 300 ],
                    [ 105, 122 ],
                    [ 201, 118 ],
                    [ 149, 186 ],
                    [ 154, 231 ],
                    [ 109, 228 ],
                    [ 197, 223 ],
                    [ 149, 96 ],
                    [ 150, 283 ]
                ]
            ],
            "states": [ //[images[num], vertices[num]]
                [ 0, 0 ],
                [ 1, 1 ]
            ],
            "animation": [
                [ 0, 0, 1 ],
                [ 0, 1, 2 ],
                [ 1, 1, 1 ]
            ]   //[ start state[num], end state[num], duration] [delay] ]
        },
        params2 = {
            "w": 310,
            "h": 500,
            "flexible": true,
            "loop": true,
            "yoyo": true,
            "images": ["img/03.jpg", "img/04.jpg", "img/05.jpg", "img/06.jpg", "img/07.jpg"],
            "vertices": [
                [
                    [ 0, 0 ],
                    [ 155, 0 ],
                    [ 310, 0 ],
                    [ 0, 250 ],
                    [ 310, 250 ],
                    [ 0, 500 ],
                    [ 155, 500 ],
                    [ 310, 500 ],
                    [ 136, 85 ],
                    [ 87, 113 ],
                    [ 200, 267 ],
                    [ 72, 359 ],
                    [ 43, 217 ],
                    [ 118, 184 ],
                    [ 125, 34 ],
                    [ 84, 68 ],
                    [ 250, 459 ],
                    [ 159, 479 ],
                    [ 97, 249 ],
                    [ 56, 452 ],
                    [ 189, 171 ]
                ],
                [
                    [ 0, 0 ],
                    [ 155, 0 ],
                    [ 310, 0 ],
                    [ 0, 250 ],
                    [ 310, 250 ],
                    [ 0, 500 ],
                    [ 155, 500 ],
                    [ 310, 500 ],
                    [ 218, 87 ],
                    [ 157, 114 ],
                    [ 289, 287 ],
                    [ 116, 340 ],
                    [ 52, 194 ],
                    [ 197, 196 ],
                    [ 219, 39 ],
                    [ 155, 59 ],
                    [ 236, 452 ],
                    [ 187, 469 ],
                    [ 94, 224 ],
                    [ 38, 441 ],
                    [ 223, 176 ]
                ],
                [
                    [ 0, 0 ],
                    [ 155, 0 ],
                    [ 310, 0 ],
                    [ 0, 250 ],
                    [ 310, 250 ],
                    [ 0, 500 ],
                    [ 155, 500 ],
                    [ 310, 500 ],
                    [ 290, 286 ],
                    [ 225, 340 ],
                    [ 215, 483 ],
                    [ 39, 439 ],
                    [ 114, 339 ],
                    [ 44, 217 ],
                    [ 147, 103 ],
                    [ 196, 186 ],
                    [ 214, 88 ]
                ],
                [
                    [ 0, 0 ],
                    [ 155, 0 ],
                    [ 310, 0 ],
                    [ 0, 250 ],
                    [ 310, 250 ],
                    [ 0, 500 ],
                    [ 155, 500 ],
                    [ 310, 500 ],
                    [ 302, 313 ],
                    [ 224, 363 ],
                    [ 229, 484 ],
                    [ 54, 445 ],
                    [ 156, 339 ],
                    [ 66, 191 ],
                    [ 147, 103 ],
                    [ 196, 186 ],
                    [ 243, 95 ]
                ],
                [
                    [ 0, 0 ],
                    [ 155, 0 ],
                    [ 310, 0 ],
                    [ 0, 250 ],
                    [ 310, 250 ],
                    [ 0, 500 ],
                    [ 155, 500 ],
                    [ 310, 500 ],
                    [ 292, 295 ],
                    [ 215, 369 ],
                    [ 223, 473 ],
                    [ 41, 447 ],
                    [ 153, 335 ],
                    [ 70, 199 ],
                    [ 195, 102 ],
                    [ 216, 191 ],
                    [ 233, 98 ]
                ],
                [
                    [ 0, 0 ],
                    [ 155, 0 ],
                    [ 310, 0 ],
                    [ 0, 250 ],
                    [ 310, 250 ],
                    [ 0, 500 ],
                    [ 155, 500 ],
                    [ 310, 500 ],
                    [ 266, 318 ],
                    [ 215, 369 ],
                    [ 237, 475 ],
                    [ 111, 439 ],
                    [ 198, 339 ],
                    [ 134, 209 ],
                    [ 232, 117 ],
                    [ 245, 224 ],
                    [ 255, 107 ]
                ],
                [
                    [ 0, 0 ],
                    [ 155, 0 ],
                    [ 310, 0 ],
                    [ 0, 250 ],
                    [ 310, 250 ],
                    [ 0, 500 ],
                    [ 155, 500 ],
                    [ 310, 500 ],
                    [ 247, 62 ],
                    [ 75, 207 ],
                    [ 199, 339 ],
                    [ 93, 438 ],
                    [ 242, 210 ]
                ],
                [
                    [ 0, 0 ],
                    [ 155, 0 ],
                    [ 310, 0 ],
                    [ 0, 250 ],
                    [ 310, 250 ],
                    [ 0, 500 ],
                    [ 155, 500 ],
                    [ 310, 500 ],
                    [ 241, 82 ],
                    [ 137, 215 ],
                    [ 233, 350 ],
                    [ 170, 436 ],
                    [ 248, 204 ]
                ]
            ],
            "states": [
                [ 0, 0 ],
                [ 1, 1 ],
                [ 1, 2 ],
                [ 2, 3 ],
                [ 2, 4 ],
                [ 3, 5 ],
                [ 3, 6 ],
                [ 4, 7 ]
            ],
            "animation": [
                [ 0, 0, .5 ],
                [ 0, 1, 1 ],
                [ 1, 1, .5 ],
                [ 2, 3, 1 ],
                [ 3, 3, .5 ],
                [ 4, 5, 1 ],
                [ 5, 5, .5 ],
                [ 6, 7, 1 ],
                [ 7, 7, .5 ]
            ]
        },
        params3 = {
            "w": 300,
            "h": 245,
            "flexible": true,
            "loop": true,
            "yoyo": false,
            "images": ["img/08.jpg", "img/09.jpg", "img/10.jpg", "img/11.jpg"],
            "vertices": [
                [
                    [ 0, 0 ],
                    [ 150, 0 ],
                    [ 300, 0 ],
                    [ 0, 122.5 ],
                    [ 300, 122.5 ],
                    [ 0, 245 ],
                    [ 150, 245 ],
                    [ 300, 245 ],
                    [ 116, 110 ],
                    [ 205, 120 ],
                    [ 171, 165 ],
                    [ 154, 196 ],
                    [ 198, 187 ],
                    [ 115, 180 ],
                    [ 165, 106 ],
                    [ 169, 32 ],
                    [ 149, 239 ],
                    [ 66, 176 ],
                    [ 52, 141 ],
                    [ 244, 152 ],
                    [ 231, 190 ],
                    [ 98, 80 ],
                    [ 237, 89 ],
                    [ 47, 36 ],
                    [ 274, 33 ]
                ],
                [
                    [ 0, 0 ],
                    [ 150, 0 ],
                    [ 300, 0 ],
                    [ 0, 122.5 ],
                    [ 300, 122.5 ],
                    [ 0, 245 ],
                    [ 150, 245 ],
                    [ 300, 245 ],
                    [ 123, 110 ],
                    [ 201, 118 ],
                    [ 165, 152 ],
                    [ 160, 192 ],
                    [ 189, 199 ],
                    [ 127, 197 ],
                    [ 163, 92 ],
                    [ 169, 16 ],
                    [ 154, 239 ],
                    [ 82, 213 ],
                    [ 70, 172 ],
                    [ 238, 180 ],
                    [ 223, 221 ],
                    [ 105, 79 ],
                    [ 218, 85 ],
                    [ 47, 36 ],
                    [ 274, 33 ]
                ],
                [
                    [ 0, 0 ],
                    [ 150, 0 ],
                    [ 300, 0 ],
                    [ 0, 122.5 ],
                    [ 300, 122.5 ],
                    [ 0, 245 ],
                    [ 150, 245 ],
                    [ 300, 245 ],
                    [ 122, 110 ],
                    [ 200, 116 ],
                    [ 160, 152 ],
                    [ 140, 160 ],
                    [ 177, 165 ],
                    [ 157, 194 ],
                    [ 125, 194 ],
                    [ 188, 199 ],
                    [ 68, 170 ],
                    [ 237, 177 ],
                    [ 165, 15 ],
                    [ 164, 94 ],
                    [ 87, 68 ],
                    [ 238, 79 ]
                ],
                [
                    [ 0, 0 ],
                    [ 150, 0 ],
                    [ 300, 0 ],
                    [ 0, 122.5 ],
                    [ 300, 122.5 ],
                    [ 0, 245 ],
                    [ 150, 245 ],
                    [ 300, 245 ],
                    [ 125, 111 ],
                    [ 203, 115 ],
                    [ 164, 145 ],
                    [ 135, 156 ],
                    [ 191, 155 ],
                    [ 162, 193 ],
                    [ 125, 194 ],
                    [ 199, 193 ],
                    [ 66, 173 ],
                    [ 245, 181 ],
                    [ 166, 26 ],
                    [ 165, 102 ],
                    [ 87, 68 ],
                    [ 243, 79 ]
                ],
                [
                    [ 0, 0 ],
                    [ 150, 0 ],
                    [ 300, 0 ],
                    [ 0, 122.5 ],
                    [ 300, 122.5 ],
                    [ 0, 245 ],
                    [ 150, 245 ],
                    [ 300, 245 ],
                    [ 126, 110 ],
                    [ 202, 117 ],
                    [ 162, 148 ],
                    [ 135, 154 ],
                    [ 191, 155 ],
                    [ 161, 191 ],
                    [ 121, 195 ],
                    [ 198, 195 ],
                    [ 67, 167 ],
                    [ 256, 183 ],
                    [ 67, 36 ],
                    [ 272, 50 ],
                    [ 49, 205 ]
                ],
                [
                    [ 0, 0 ],
                    [ 150, 0 ],
                    [ 300, 0 ],
                    [ 0, 122.5 ],
                    [ 300, 122.5 ],
                    [ 0, 245 ],
                    [ 150, 245 ],
                    [ 300, 245 ],
                    [ 119, 108 ],
                    [ 206, 116 ],
                    [ 159, 169 ],
                    [ 136, 163 ],
                    [ 187, 166 ],
                    [ 154, 200 ],
                    [ 120, 193 ],
                    [ 191, 197 ],
                    [ 60, 149 ],
                    [ 250, 183 ],
                    [ 39, 10 ],
                    [ 280, 31 ],
                    [ 14, 231 ]
                ],
                [
                    [ 0, 0 ],
                    [ 150, 0 ],
                    [ 300, 0 ],
                    [ 0, 122.5 ],
                    [ 300, 122.5 ],
                    [ 0, 245 ],
                    [ 150, 245 ],
                    [ 300, 245 ],
                    [ 117, 107 ],
                    [ 204, 115 ],
                    [ 161, 162 ],
                    [ 132, 162 ],
                    [ 185, 163 ],
                    [ 154, 201 ],
                    [ 116, 190 ],
                    [ 191, 194 ],
                    [ 55, 153 ],
                    [ 251, 180 ],
                    [ 117, 34 ],
                    [ 163, 98 ]
                ],
                [
                    [ 0, 0 ],
                    [ 150, 0 ],
                    [ 300, 0 ],
                    [ 0, 122.5 ],
                    [ 300, 122.5 ],
                    [ 0, 245 ],
                    [ 150, 245 ],
                    [ 300, 245 ],
                    [ 117, 111 ],
                    [ 209, 122 ],
                    [ 171, 173 ],
                    [ 136, 155 ],
                    [ 194, 154 ],
                    [ 156, 199 ],
                    [ 113, 180 ],
                    [ 198, 190 ],
                    [ 53, 137 ],
                    [ 243, 155 ],
                    [ 116, 26 ],
                    [ 165, 123 ]
                ]
            ],
            "states": [
                [ 0, 0 ],
                [ 1, 1 ],
                [ 1, 2 ],
                [ 2, 3 ],
                [ 2, 4 ],
                [ 3, 5 ],
                [ 3, 6 ],
                [ 0, 7 ]
            ],
            "animation": [
                [ 0, 0, .4 ],
                [ 0, 1, .9 ],
                [ 1, 1, .4 ],
                [ 2, 3, .9 ],
                [ 3, 3, .4 ],
                [ 4, 5, .9 ],
                [ 5, 5, .4 ],
                [ 6, 7, .9 ]
            ]
        },
        params4 = {
            "w": 300,
            "h": 245,
            "flexible": true,
            "loop": true,
            "yoyo": true,
            "vertices": [
                [
                    [0, 0],
                    [150, 0],
                    [300, 0],
                    [0, 123],
                    [300, 123],
                    [0, 245],
                    [150, 245],
                    [300, 245],
                    [13, 13],
                    [282, 14],
                    [13, 231],
                    [280, 232]
                ],
                [
                    [0, 0],
                    [150, 0],
                    [300, 0],
                    [0, 123],
                    [300, 123],
                    [0, 245],
                    [150, 245],
                    [300, 245],
                    [164, 234],
                    [7, 126],
                    [291, 121],
                    [153, 17]
                ],
                [
                    [0, 0],
                    [150, 0],
                    [300, 0],
                    [0, 123],
                    [300, 123],
                    [0, 245],
                    [150, 245],
                    [300, 245],
                    [157, 149],
                    [130, 132],
                    [179, 132],
                    [156, 115]
                ],
                [
                    [0, 0],
                    [150, 0],
                    [300, 0],
                    [0, 123],
                    [300, 123],
                    [0, 245],
                    [150, 245],
                    [300, 245],
                    [143, 11],
                    [286, 127],
                    [10, 121],
                    [159, 235]
                ]
            ],
            "images": ["img/08.jpg", "img/09.jpg", "img/10.jpg", "img/11.jpg"],
            "states": [
                [0, 0],
                [1, 1],
                [2, 2],
                [3, 3]
            ],
            "animation": [
                [0, 0, 0.5],
                [0, 1, 1],
                [1, 1, 0.5],
                [1, 2, 1],
                [2, 2, 0.5],
                [2, 3, 1],
                [3, 3, 0.5]
            ]
        };

    vi.Update.setFps(30);


    loop(300, 245);
    function loop(w, h) {
        vi.Tween.to(canvas4, 1, {width: w, height: h, ease: "easeOutBounce"});
        vi.Tween.to(canvas5, 1, {width: w, height: h, onComplete: loop, onCompleteParams: [Math.random() * 300 + 100, Math.random() * 300 + 100], ease: "easeOutBounce"})
    }


    var m1 = new vi.Morphing(canvas1, params1);
    var m2 = new vi.Morphing(canvas2, params2);
    var m3 = new vi.Morphing(canvas3, params3);
    var m4 = new vi.Morphing(canvas4, params3);
    var m5 = new vi.Morphing(canvas5, params4);
    m5.flexible = false;

    canvas1.onclick =
        canvas2.onclick =
            canvas3.onclick =
                canvas4.onclick =
                    canvas5.onclick = onClickCanvas;

    function onClickCanvas(e) {
        var m;
        switch (e.currentTarget) {
            case (canvas1):
                m = m1;
                break;
            case (canvas2):
                m = m2;
                break;
            case (canvas3):
                m = m3;
                break;
            case (canvas4):
                m = m4;
                break;
            case (canvas5):
                m = m5;
                break;
        }

        if (m.paused)
            m.resume();
        else
            m.pause();

    }

    /* tweener demonstration
    var obj1 = {x: 1};
    var obj2 = {x: 1};

    vi.Tween.to(obj2, .1, {x: 10, onUpdate: onUpdate});

    vi.Tween.to(obj1, .3, {x: 10, onUpdate: onUpdate})
        .to(obj2, .2, {x: 20, delay: 1, onUpdate: onUpdate, onStart: function () {
            console.log("start");
        }})
        .to(obj1, .3, {x: 0, onUpdate: onUpdate});
    function onUpdate() {
        console.log(obj1.x + ",  " + obj2.x);
    }
    */
}


var s = document.readyState;
if (s === 'complete' || s === 'loaded' || s === 'interactive') init();
else document.addEventListener('DOMContentLoaded', init, false);
